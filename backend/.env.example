# MAKKO INTELLIGENCE - ULTRA-SECURE AUTHENTICATION SYSTEM
# Environment Configuration Template
# Copy to .env and customize for your environment

# ==================== APPLICATION SETTINGS ====================
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# ==================== SECURITY SETTINGS ====================
# CRITICAL: Generate a secure secret key (minimum 32 characters)
# Use: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-ultra-secure-secret-key-change-in-production-32-chars-minimum

# JWT Configuration
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=30

# ==================== DATABASE CONFIGURATION ====================
# PostgreSQL Database URL
DATABASE_URL=postgresql://makko_user:ultra_secure_password_change_in_production@localhost:5432/tumataxi_auth

# Database Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_RECYCLE=3600

# ==================== REDIS CONFIGURATION ====================
# Redis URL for caching and sessions
REDIS_URL=redis://:ultra_secure_redis_password@localhost:6379/0
REDIS_PASSWORD=ultra_secure_redis_password

# ==================== CORS & SECURITY HEADERS ====================
# Allowed origins (comma-separated)
ALLOWED_ORIGINS=https://tumataxi.co.mz,https://app.tumataxi.co.mz,https://admin.tumataxi.co.mz

# Trusted hosts (comma-separated)
TRUSTED_HOSTS=tumataxi.co.mz,app.tumataxi.co.mz,api.tumataxi.co.mz,admin.tumataxi.co.mz

# ==================== RATE LIMITING ====================
ENABLE_RATE_LIMITING=true
LOGIN_RATE_LIMIT=5/minute
REGISTER_RATE_LIMIT=3/minute
PASSWORD_RESET_RATE_LIMIT=2/hour

# ==================== MONITORING & METRICS ====================
ENABLE_METRICS=true
METRICS_PATH=/metrics
ENABLE_SECURITY_MONITORING=true

# Prometheus Configuration
PROMETHEUS_PORT=9090

# Grafana Configuration
GRAFANA_PASSWORD=secure_grafana_password
GRAFANA_PORT=3000

# ==================== EMAIL CONFIGURATION ====================
# Email service for notifications (choose one)
EMAIL_PROVIDER=sendgrid  # sendgrid, ses, smtp

# SendGrid Configuration
SENDGRID_API_KEY=your_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@tumataxi.co.mz
SENDGRID_FROM_NAME=TumaTaxi Security

# AWS SES Configuration
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=us-east-1
SES_FROM_EMAIL=noreply@tumataxi.co.mz

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_USE_TLS=true

# ==================== SMS CONFIGURATION ====================
# SMS service for 2FA (choose one)
SMS_PROVIDER=twilio  # twilio, aws_sns

# Twilio Configuration
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_FROM_NUMBER=+1234567890

# AWS SNS Configuration
SNS_REGION=us-east-1

# ==================== EXTERNAL SERVICES ====================
# GeoIP Service
GEOIP_PROVIDER=maxmind  # maxmind, ipapi
MAXMIND_LICENSE_KEY=your_maxmind_license_key
MAXMIND_DATABASE_PATH=/app/data/GeoLite2-City.mmdb

# ==================== LOGGING & MONITORING ====================
# Structured Logging
LOG_FORMAT=json
LOG_FILE_PATH=/app/logs/auth.log
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=5

# Sentry Error Tracking
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ==================== BACKUP & RECOVERY ====================
# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=tumataxi-backups
BACKUP_S3_PREFIX=auth-db/

# ==================== SSL/TLS CONFIGURATION ====================
# SSL Certificate Paths
SSL_CERT_PATH=/etc/ssl/certs/tumataxi.crt
SSL_KEY_PATH=/etc/ssl/private/tumataxi.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# Let's Encrypt
LETSENCRYPT_EMAIL=admin@tumataxi.co.mz
LETSENCRYPT_DOMAINS=api.tumataxi.co.mz,auth.tumataxi.co.mz

# ==================== DEVELOPMENT SETTINGS ====================
# Development-only settings (ignored in production)
DEV_RELOAD=true
DEV_DEBUG_SQL=false
DEV_MOCK_EMAIL=true
DEV_MOCK_SMS=true

# ==================== PERFORMANCE TUNING ====================
# Worker Configuration
WORKERS=4
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKER_CONNECTIONS=1000
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=50

# Connection Limits
MAX_CONCURRENT_CONNECTIONS=1000
KEEPALIVE_TIMEOUT=5

# ==================== SECURITY HARDENING ====================
# Account Security
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCK_DURATION_MINUTES=30
SESSION_TIMEOUT_MINUTES=120
MAX_CONCURRENT_SESSIONS=3

# Password Policy
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGITS=true
PASSWORD_REQUIRE_SPECIAL=true

# Two-Factor Authentication
TOTP_ISSUER_NAME=TumaTaxi
BACKUP_CODES_COUNT=10

# ==================== COMPLIANCE & AUDIT ====================
# Data Retention
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for compliance
SESSION_LOG_RETENTION_DAYS=90
SECURITY_EVENT_RETENTION_DAYS=365

# Privacy
GDPR_COMPLIANCE=true
DATA_ANONYMIZATION_ENABLED=true
RIGHT_TO_BE_FORGOTTEN=true

# ==================== DEPLOYMENT SETTINGS ====================
# Container Settings
CONTAINER_PORT=8000
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# Load Balancer
LB_HEALTH_CHECK_PATH=/health
LB_STICKY_SESSIONS=true

# Auto-scaling
MIN_REPLICAS=2
MAX_REPLICAS=10
CPU_THRESHOLD=70
MEMORY_THRESHOLD=80

# ==================== FEATURE FLAGS ====================
# Feature toggles
ENABLE_2FA=true
ENABLE_BIOMETRIC_AUTH=false
ENABLE_SOCIAL_LOGIN=false
ENABLE_PASSWORDLESS_LOGIN=false
ENABLE_DEVICE_TRUST=true
ENABLE_GEOFENCING=true

# ==================== THIRD-PARTY INTEGRATIONS ====================
# Payment Gateway (for premium features)
STRIPE_PUBLISHABLE_KEY=pk_live_your_stripe_key
STRIPE_SECRET_KEY=sk_live_your_stripe_secret
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Analytics
GOOGLE_ANALYTICS_ID=GA-XXXXXXXXX
MIXPANEL_TOKEN=your_mixpanel_token

# ==================== MOBILE APP SETTINGS ====================
# Push Notifications
FCM_SERVER_KEY=your_fcm_server_key
APNS_KEY_ID=your_apns_key_id
APNS_TEAM_ID=your_apns_team_id
APNS_BUNDLE_ID=co.mz.tumataxi

# Deep Links
DEEP_LINK_SCHEME=tumataxi
UNIVERSAL_LINK_DOMAIN=app.tumataxi.co.mz

# ==================== NOTES ====================
# 1. Never commit this file with real credentials to version control
# 2. Use environment-specific .env files (.env.production, .env.staging)
# 3. Rotate secrets regularly (at least every 90 days)
# 4. Use secrets management systems in production (AWS Secrets Manager, HashiCorp Vault)
# 5. Monitor for credential leaks using tools like GitGuardian
# 6. Implement proper backup and disaster recovery procedures
# 7. Regular security audits and penetration testing
# 8. Keep all dependencies updated and scan for vulnerabilities